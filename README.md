# Assembler. Транслятор и модель

- Мокров Семён Андреевич, гр. Р33121
- `asm | risc | neum | hw | tick | struct | stream | mem | prob5`

## Язык программирования

``` ebnf
program ::= line "\n" program

line ::= label
       | comment
       | command
       | section

label ::= name ":"

comment ::= ; <any sequence>

command ::= "\t" operation_2_args " " operand ", " operand |
            "\t" operation_1_arg " " operand |
            "\t" operation_0_args |

section ::= "section ." section_name

section_name ::= "text" | "data"

operation_2_args ::= "add" | "sub" | "mov" | "div" | "mod" | "cmp"

operation_1_arg ::= "beq" | "bne" | "jmp" | "word"

operation_0_args ::= "exit"

operand ::= "rax" | name | number    ; "name" here is label name

name ::= [a-z_]+
          
number ::= [-2^32; 2^32 - 1]

```

Код выполняется последовательно. Операции:

- `add <arg1> <arg2>` -- прибавить ко второму аргументу первый
- `sub <arg1> <arg2>` -- вычесть из второго аргумента первый
- `mov <arg1> <arg2>` -- скопировать значение из первого аргумента во второй
- `div <arg1> <arg2>` -- получить целую часть от деления первого аргумента на второй
- `mod <arg1> <arg2>` -- получить остаток от деления первого аргумента на второй
- `mul <arg1> <arg2>` -- получить произведение первого аргумента на второй
- `cmp <arg1> <arg2>` -- получить результат сравнения первого аргумента со вторым (0, если аргументы равны)
- `beq <label>` -- если значение в аккумуляторе равно нулю, перейти на аргумент-метку
- `bne <label>` -- если значение в аккумуляторе отлично от нуля, перейти на аргумент-метку
- `jmp <label>` -- безусловный переход на аргумент-метку
- `print <arg>` -- распечатать в поток вывода значение из аргумента
- `read <arg>` -- прочитать в аргумент значение из потока ввода
- `word <number>` -- объявление переменной
- `exit` -- завершить выполнение программы

Поддерживаемые аргументы:
- аккумулятор `rax`
- название **объявленной** метки
- число в диапазоне [-2^32; 2^32 - 1]

Дополнительные конструкции:
- `; <any sequence not containing ';'>` - комментарий
- `section .text` - объявление секции кода
- `section .data` - объявление секции данных
- `<label>:` - метки для переходов / названия переменных

*Примечания:
- Результаты операций `add` и `sub` помещаются во второй аргумент, в остальных случаях - в `acc`
- Должна присутствовать метка `start` - точка входа в программ